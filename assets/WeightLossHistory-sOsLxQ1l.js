import{r as j,j as e,C as w,b as L,c as k,d as $,e as f,h as F}from"./index-BIXGV2mp.js";import{P as c}from"./index-w-eSnYTo.js";const n=({title:d,value:l,subValue:r,colorScheme:i="blue"})=>e.jsx(w,{className:`bg-${i}-50`,children:e.jsxs(f,{className:"pt-4 pb-4",children:[e.jsx("div",{className:`text-sm text-${i}-600 mb-1`,children:d}),e.jsx("div",{className:`text-lg font-bold text-${i}-700`,children:l}),r&&e.jsx("div",{className:`text-sm text-${i}-600`,children:r})]})});n.propTypes={title:c.string.isRequired,value:c.node.isRequired,subValue:c.node,colorScheme:c.string};const E=()=>{const[d,l]=j.useState({closings:[],isLoading:!0,error:null}),r=(t,s=0)=>t==null||t===""||isNaN(Number(t))?s:Number(t),i=t=>{try{return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(s){return console.error("Error formatting date:",s),"Invalid Date"}};j.useEffect(()=>{(async()=>{try{const s=await Promise.resolve(F());l({closings:Array.isArray(s)?s:[],isLoading:!1,error:null})}catch(s){console.error("Error loading weight loss history:",s),l({closings:[],isLoading:!1,error:"Failed to load weight loss history"})}})()},[]);const o=(()=>{const{closings:t}=d;if(!t||!t.length)return{average:{},highest:{},lowest:{}};try{const s=a=>a.length?a.reduce((N,b)=>N+b,0)/a.length:0,g=a=>a.length?Math.max(...a):0,h=a=>a.length?Math.min(...a):0,m=t.map(a=>r(a.weightLoss)),p=t.map(a=>r(a.weightLossPercentage)),u=t.map(a=>r(a.birdLoss));return{average:{weight:s(m),percentage:s(p),birds:s(u)},highest:{weight:g(m),percentage:g(p),birds:g(u)},lowest:{weight:h(m),percentage:h(p),birds:h(u)}}}catch(s){return console.error("Error calculating weight loss statistics:",s),{average:{},highest:{},lowest:{}}}})(),{closings:x,isLoading:v,error:y}=d;return v?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading weight loss history..."}):y?e.jsx("div",{className:"bg-red-50 p-4 rounded-lg text-red-600",children:y}):!x||x.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No weight loss data recorded yet."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(n,{title:"Average Weight Loss",value:`${o.average.weight.toFixed(2)}kg`,subValue:`${o.average.percentage.toFixed(2)}% of stock`,colorScheme:"blue"}),e.jsx(n,{title:"Highest Weight Loss",value:`${o.highest.weight.toFixed(2)}kg`,subValue:`${o.highest.percentage.toFixed(2)}% of stock`,colorScheme:"amber"}),e.jsx(n,{title:"Lowest Weight Loss",value:`${o.lowest.weight.toFixed(2)}kg`,subValue:`${o.lowest.percentage.toFixed(2)}% of stock`,colorScheme:"green"})]}),e.jsxs(w,{children:[e.jsxs(L,{children:[e.jsx(k,{children:"Weight Loss History"}),e.jsx($,{children:"Historical record of weight loss during daily operations"})]}),e.jsx(f,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Stock Overview"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Weight Loss"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Birds"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map((t,s)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:i(t.date)}),e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.jsxs("div",{children:["Expected: ",r(t.expectedStock).toFixed(2),"kg"]}),e.jsxs("div",{children:["Actual: ",r(t.actualStock).toFixed(2),"kg"]}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:t.estimationMethod==="liveRate"?"Live weight":"Meat weight"})]}),e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap",children:[e.jsxs("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full 
                        ${r(t.weightLoss)>0?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:[r(t.weightLoss).toFixed(2),"kg"]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[r(t.weightLossPercentage).toFixed(2),"% of stock"]})]}),e.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:["Expected: ",r(t.expectedBirds)]}),e.jsxs("div",{children:["Actual: ",r(t.actualBirds)]})]}),e.jsx("div",{className:"mt-1",children:e.jsxs("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full 
                          ${r(t.birdLoss)>0?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800"}`,children:["Loss: ",r(t.birdLoss)," birds"]})})]})]},s))})]})})})]})]})};export{E as default};
